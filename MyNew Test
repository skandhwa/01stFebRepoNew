const { test, expect } = require('@playwright/test');

test('POST API test with body, token, and headers', async ({ request }) => {
  // Define your API URL
  const apiUrl = 'https://api.example.com/data';

  // Define your bearer token
  const token = 'your_real_bearer_token_here';

  // Define your request body
  const requestBody = {
    name: 'John Doe',
    email: 'john@example.com',
    role: 'admin'
  };

  // Make the POST request
  const response = await request.post(apiUrl, {
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json',
      'Custom-Header': 'CustomValue' // optional additional headers
    },
    data: requestBody, // <-- Playwright uses `data` for body
  });

  // Assert response status
  expect(response.status()).toBe(201); // or 200, depending on your API
  
  // Parse and validate response body
  const responseBody = await response.json();

  expect(responseBody).toHaveProperty('id'); // Check if 'id' exists
  expect(responseBody.name).toBe('John Doe'); // Validate returned name
  expect(responseBody.email).toBe('john@example.com'); // Validate returned email
});
